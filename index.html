<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNVUL MUSIC !!</title>
        <link rel="icon" type="image/png" href="unvul-logo.ico">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000;
            height: 100vh;
            display: flex;
            flex-direction: column;
            color: white;
            overflow: hidden;
        }
        
     #playlist {
    background: rgba(20, 20, 20, 0.95);
    padding: 10px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    gap: 10px;
    overflow-x: auto;
    align-items: center;
    max-height: 60px;
    transition: transform 0.3s, opacity 0.3s;
    position: absolute;  /* relativeì—ì„œ absoluteë¡œ ë³€ê²½ */
    top: 0;
    left: 0;
    right: 0;
    z-index: 50;
}
        
        #playlist.hidden {
            transform: translateY(-100%);
            opacity: 0;
            pointer-events: none;
        }
        

        
        #playlist::-webkit-scrollbar {
            height: 4px;
        }
        
        #playlist::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        
        #playlist::-webkit-scrollbar-thumb {
            background: rgba(10, 10, 10, 0.5);
            border-radius: 2px;
        }
        
        .playlist-item {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 0.9em;
            border: 1px solid transparent;
        }
        
        .playlist-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(0, 240, 255, 0.3);
        }
        
        .playlist-item.active {
            background: rgba(0, 240, 255, 0.2);
            border-color: #1b1d1d;
        }
        
        #togglePlaylistBtn {
            position: fixed;
            top: 70px;
            left: 10px;
            z-index: 100;
            padding: 10px 20px;
            background: rgba(0, 240, 255, 0.2);
            border: 2px solid rgba(27, 27, 27, 0.5);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }
        
        #togglePlaylistBtn:hover {
            background: rgba(0, 240, 255, 0.4);
            transform: scale(1.05);
        }
        
        #container {
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* ì¶”ê°€: íšŒì „ ì• ë‹ˆë©”ì´ì…˜ */
#album-art.spinning {
    animation: spin 5s linear infinite;
}

@keyframes spin {
    from {
        transform: translate(-50%, -50%) rotate(0deg);
    }
    to {
        transform: translate(-50%, -50%) rotate(360deg);
    }
}

        #album-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.5s;
    filter: blur(40px) brightness(0.4);
    z-index: 0;
}
#loopBtn.active {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.8);
}
#album-bg.show {
    opacity: 0.6;
}
        
        #canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        #album-art {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid rgba(0, 240, 255, 0.5);
            box-shadow: 0 0 30px rgba(0, 240, 255, 0.5);
            display: none;
            cursor: pointer;
            
            pointer-events: auto;
               transition: transform 0.3s ease; /* ì¶”ê°€ */
        }
        
        #album-art.show {
            display: block;
        }
        
        #controls {
            position: absolute;
            bottom: 100px;
            display: flex;
            gap: 15px;
            z-index: 10;
        }
        
        button {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
            transition: all 0.3s;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        #progress-container {
            position: absolute;
            bottom: 50px;
            width: 80%;
            max-width: 800px;
            z-index: 10;
        }
        
        #progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
            margin-bottom: 5px;
        }
        
        #progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00f0ff, #667eea);
            border-radius: 3px;
            width: 0%;
            transition: width 0.1s;
        }
        
        #time-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            opacity: 0.7;
        }

        #createQueueBtn {
    position: fixed;
    top: 70px;
    left: 150px;
    z-index: 100;
    padding: 10px 20px;
    background: rgba(100, 200, 100, 0.2);
    border: 2px solid rgba(100, 200, 100, 0.5);
    color: white;
    border-radius: 25px;
    cursor: pointer;
    font-size: 0.9em;
    transition: all 0.3s;
}

#createQueueBtn:hover {
    background: rgba(100, 200, 100, 0.4);
    transform: scale(1.05);
}

#queueModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 200;
    justify-content: center;
    align-items: center;
}

#queueModal.show {
    display: flex;
}

#queueModalContent {
    background: rgba(30, 30, 30, 0.95);
    padding: 30px;
    border-radius: 20px;
    width: 90%;
    max-width: 800px;
    max-height: 80vh;
    overflow-y: auto;
    border: 2px solid rgba(255, 255, 255, 0.2);
}

@media (max-width: 768px) {
    #queueModalContent {
        width: 95%;
        max-height: 85vh;
        padding: 15px;
        border-radius: 15px;
    }
    
    #queueModalContent h2 {
        font-size: 1.3em;
        margin-bottom: 15px;
        text-align: center;
    }
    
    .queue-section {
        flex-direction: column;
        gap: 15px;
    }
    
    .available-songs, .selected-queue {
        max-height: 25vh;
        overflow-y: auto;
    }
    
    .song-option, .queue-item {
        padding: 12px 10px;
        font-size: 0.95em;
        touch-action: manipulation;
    }
    
    .queue-number {
        min-width: 28px;
        padding: 4px 8px;
        font-size: 0.9em;
    }
    
    .remove-queue-btn {
        padding: 6px 12px;
        font-size: 0.9em;
        min-width: 40px;
    }
    
    .queue-loop-option {
        padding: 12px;
        margin-bottom: 15px;
    }
    
    .queue-loop-label {
        font-size: 1em;
    }
    
    .queue-buttons {
        flex-direction: column;
        gap: 8px;
        margin-top: 15px;
    }
    
    .queue-buttons button {
        width: 100%;
        padding: 14px;
        font-size: 1em;
        border-radius: 10px;
    }
}



#queueModalContent h2 {
    margin-bottom: 20px;
    color: white;
    text-align: center;
}

.queue-section {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
}

.available-songs, .selected-queue {
    flex: 1;
    background: rgba(255, 255, 255, 0.05);
    padding: 15px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.available-songs h3, .selected-queue h3 {
    color: white;
    margin-bottom: 10px;
    font-size: 1em;
}

.song-option {
    padding: 10px;
    margin: 5px 0;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.song-option:hover {
    background: rgba(100, 200, 100, 0.3);
    transform: translateX(5px);
}

.song-option.disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.song-option.disabled:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: none;
}

.queue-item {
    padding: 10px;
    margin: 5px 0;
    background: rgba(100, 150, 255, 0.2);
    border-radius: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid rgba(100, 150, 255, 0.3);
}

.queue-number {
    background: rgba(255, 255, 255, 0.2);
    padding: 5px 10px;
    border-radius: 50%;
    font-weight: bold;
    min-width: 30px;
    text-align: center;
}

.remove-queue-btn {
    background: rgba(255, 100, 100, 0.3);
    border: 1px solid rgba(255, 100, 100, 0.5);
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.85em;
}

.remove-queue-btn:hover {
    background: rgba(255, 100, 100, 0.5);
}

.queue-buttons {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 20px;
}

#speedControlBtn {
    position: fixed;
    top: 120px;  /* 70pxì—ì„œ 120pxë¡œ ë³€ê²½ */
    left: 10px;  /* 330pxì—ì„œ 10pxë¡œ ë³€ê²½ */
    z-index: 100;
    padding: 10px 20px;
    background: rgba(255, 200, 100, 0.2);
    border: 2px solid rgba(255, 200, 100, 0.5);
    color: white;
    border-radius: 25px;
    cursor: pointer;
    font-size: 0.9em;
    transition: all 0.3s;
}

@media (max-width: 768px) {
    #speedModalContent {
        padding: 20px 15px;
        border-radius: 15px;
        width: 90%;
        max-width: 400px;
    }
    
    #speedModalContent h2 {
        font-size: 1.5em;
        margin-bottom: 20px;
    }
    
    .speed-options {
        flex-direction: column;
        gap: 12px;
        margin-bottom: 20px;
    }
    
    .speed-option {
        padding: 20px 15px;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        min-width: auto;
        width: 100%;
        gap: 15px;
        touch-action: manipulation;
    }
    
    .speed-option:active {
        transform: scale(0.98);
    }
    
    .speed-icon {
        font-size: 2em;
        flex-shrink: 0;
    }
    
    .speed-info {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        flex: 1;
    }
    
    .speed-name {
        font-size: 1.1em;
    }
    
    .speed-value {
        font-size: 0.85em;
        margin-top: 2px;
    }
    
    .modal-close-btn {
        width: 100%;
        padding: 14px;
        font-size: 1em;
        border-radius: 10px;
    }
}

#speedControlBtn:hover {
    background: rgba(255, 200, 100, 0.4);
    transform: scale(1.05);
}
/* ì†ë„ ì¡°ì ˆ ëª¨ë‹¬ */
#speedModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 200;
    justify-content: center;
    align-items: center;
}

#speedModal.show {
    display: flex;
}

#speedModalContent {
    background: rgba(30, 30, 30, 0.95);
    padding: 40px;
    border-radius: 20px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    text-align: center;
}

#speedModalContent h2 {
    color: white;
    margin-bottom: 30px;
    font-size: 1.8em;
}

.speed-options {
    display: flex;
    gap: 20px;
    margin-bottom: 30px;
}

.speed-option {
    flex: 1;
    padding: 30px 20px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    min-width: 120px;
}

.speed-option:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-5px);
}

.speed-option.active {
    background: rgba(100, 200, 255, 0.3);
    border-color: rgba(100, 200, 255, 0.8);
    box-shadow: 0 0 20px rgba(100, 200, 255, 0.5);
}

.speed-icon {
    font-size: 3em;
}

.speed-name {
    font-size: 1.2em;
    font-weight: bold;
    color: white;
}

.speed-value {
    font-size: 0.9em;
    color: rgba(255, 255, 255, 0.6);
}

.modal-close-btn {
    padding: 12px 30px;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    color: white;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1em;
}

.modal-close-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

.queue-buttons button {
    padding: 12px 25px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 0.95em;
    border: none;
}

#startQueueBtn {
    background: rgba(100, 200, 100, 0.3);
    border: 2px solid rgba(100, 200, 100, 0.5);
    color: white;
}

#startQueueBtn:hover {
    background: rgba(100, 200, 100, 0.5);
}

#startQueueBtn:disabled {
    background: rgba(100, 100, 100, 0.3);
    border-color: rgba(100, 100, 100, 0.5);
    cursor: not-allowed;
    opacity: 0.5;
}

#closeQueueBtn {
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    color: white;
}

#closeQueueBtn:hover {
    background: rgba(255, 255, 255, 0.2);
}

#currentQueue {
    position: fixed;
    right: 20px;
    top: 80px;
    background: rgba(30, 30, 30, 0.9);
    padding: 15px;
    border-radius: 15px;
    border: 2px solid rgba(100, 150, 255, 0.3);
    max-width: 250px;
    z-index: 90;
    display: none;
}

#currentQueue.show {
    display: block;
}

#slowedBtn.active,
#normalSpeedBtn.active,
#spedUpBtn.active {
    background: rgba(255, 100, 255, 0.3);
    border-color: rgba(255, 100, 255, 0.8);
    transform: scale(1.05);
}

#currentQueue h3 {
    color: white;
    margin-bottom: 10px;
    font-size: 0.9em;
}

.current-queue-item {
    padding: 8px;
    margin: 5px 0;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 5px;
    font-size: 0.85em;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
#volumeToggleBtn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 100;
    padding: 15px;
    background: rgba(30, 30, 30, 0.9);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.5em;
    transition: all 0.3s;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
}

#volumeToggleBtn:hover {
    background: rgba(50, 50, 50, 0.9);
    transform: scale(1.1);
}

#volumeControl {
    position: fixed;
    bottom: 80px;
    right: 20px;
    z-index: 100;
    display: none;
    align-items: center;
    gap: 10px;
    background: rgba(30, 30, 30, 0.9);
    padding: 15px 20px;
    border-radius: 50px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s;
}

@media (max-width: 768px) {
    #menuBtn {
        display: block;
        top: 70px;
        padding: 10px 16px;  /* ë” ì‘ê²Œ */
        font-size: 1.2em;  /* ë” ì‘ê²Œ */
    }
    
    /* ë…¸ë˜ ì œëª© - ì´ ë¶€ë¶„ì´ ê¸°ì¡´ì— ìˆë‹¤ë©´ êµì²´ */
     #songInfo {
        position: absolute !important;  /* ì¶”ê°€ */
        font-size: 1.5em !important;
        top: 140px !important;  /* !important ì¶”ê°€ */
        padding: 5px 10px;
        max-width: 80%;
        text-align: center;
        left: 50% !important;  /* !important ì¶”ê°€ */
        transform: translateX(-50%) !important;  /* !important ì¶”ê°€ */
        letter-spacing: 0.5px;
    }
}

@media (max-width: 768px) {
    #toggleControlsBtn {
        display: none !important;  /* ëª¨ë°”ì¼ì—ì„œ ì™„ì „íˆ ìˆ¨ê¹€ */
    }
}

#toggleControlsBtn2 {
    background: rgba(255, 255, 100, 0.2);
}

#toggleControlsBtn2:hover {
    background: rgba(255, 255, 100, 0.4);
}


@media (max-width: 768px) {
     #toggleControlsBtn {
        bottom: 195px;
        left: 50%;
        transform: translateX(-50%) scale(0.8);  /* ë²„íŠ¼ í¬ê¸°ë§Œ ì¤„ì„ */
        z-index: 100;  /* ë§¨ ìœ„ë¡œ */
    }
    
    #controls {
        bottom: 140px;  /* ì»¨íŠ¸ë¡¤ì€ ì•„ë˜ë¡œ */
        padding-top: 20px;  /* ìœ„ìª½ ì—¬ë°± */
    }
    
    #controls button {
        padding: 8px 12px;
        font-size: 0.85em;
        min-width: 80px;
    }
    
    #progress-container {
        bottom: 95px;  /* 70pxì—ì„œ 95pxë¡œ ì˜¬ë¦¼ */
    }
    
    #volumeToggleBtn {
        bottom: 20px;
    }
    
    #volumeControl {
        bottom: 75px;
    }
}

/* í–„ë²„ê±° ë©”ë‰´ */
#menuBtn {
    position: fixed;
    top: 10px;
    left: 10px;
    z-index: 100;
    padding: 6px 10px;  /* 10px 15pxì—ì„œ ì¶•ì†Œ */
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    color: white;
    border-radius: 8px;  /* 10pxì—ì„œ ì¶•ì†Œ */
    cursor: pointer;
    font-size: 1em;  /* 1.3emì—ì„œ ì¶•ì†Œ */
    transition: all 0.3s;
    display: none;
}

#menuBtn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
}

#menuPanel {
    display: none;
    position: fixed;
    top: 60px;
    left: 10px;
    z-index: 100;
    background: rgba(20, 20, 20, 0.95);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    padding: 15px;
    min-width: 200px;
    backdrop-filter: blur(10px);
}

#menuPanel.show {
    display: block;
}

#menuPanel button {
    width: 100%;
    margin-bottom: 10px;
    padding: 12px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    border-radius: 10px;
    cursor: pointer;
    font-size: 0.95em;
    transition: all 0.3s;
    text-align: left;
}

#menuPanel button:last-child {
    margin-bottom: 0;
}

#togglePlaylistBtn2 {
    background: rgba(0, 240, 255, 0.2);
}

#togglePlaylistBtn2:hover {
    background: rgba(0, 240, 255, 0.4);
}

#createQueueBtn2 {
    background: rgba(100, 200, 100, 0.2);
}

#createQueueBtn2:hover {
    background: rgba(100, 200, 100, 0.4);
}

#speedControlBtn2 {
    background: rgba(255, 200, 100, 0.2);
}

#speedControlBtn2:hover {
    background: rgba(255, 200, 100, 0.4);
}



/* ëª¨ë°”ì¼ì—ì„œë§Œ í–„ë²„ê±° ë©”ë‰´ ë³´ì´ê¸° */
@media (max-width: 768px) {
    #menuBtn {
        display: block;
    }
    
    #togglePlaylistBtn,
    #createQueueBtn,
    #speedControlBtn {
        display: none !important;
    }
    
    /* NCS ì›¨ì´ë¸Œ íš¨ê³¼ í¬ê¸° ë³µì› */

@media (max-width: 768px) {
    /* ìº”ë²„ìŠ¤ í™•ëŒ€ ì œê±° */
    /* #canvas { transform: scale(1.4); } ì‚­ì œ */
    
    /* ë°°ê²½ ì´ë¯¸ì§€ê°€ ì œëŒ€ë¡œ ë³´ì´ë„ë¡ */
    #album-bg {
        opacity: 0.6;
        z-index: 0;
    }
    
    /* ì•¨ë²” ì•„íŠ¸ í¬ê¸° ì¡°ì • */
    #album-art {
        width: 140px;
        height: 140px;
        z-index: 5;
    }
}

@media (max-width: 768px) {
    /* í–„ë²„ê±° ë©”ë‰´ ìœ„ì¹˜ ì¡°ì • */
    #menuBtn {
        display: block;
        top: 70px;  /* 10pxì—ì„œ 70pxë¡œ ë³€ê²½ */
    }
    
    /* ë…¸ë˜ ì œëª© ëª¨ë°”ì¼ ìµœì í™” */
    #songInfo {
        font-size: 1.2em;  /* 2emì—ì„œ 1.2emìœ¼ë¡œ ì¶•ì†Œ */
        top: 120px;  /* 80pxì—ì„œ 120pxë¡œ ì´ë™ (í–„ë²„ê±° ë©”ë‰´ ì•„ë˜) */
        padding: 8px 15px;
        max-width: 85%;
        text-align: center;  /* ì¤‘ì•™ ì •ë ¬ ì¶”ê°€ */
        left: 50%;  /* ì¶”ê°€ */
        transform: translateX(-50%);  /* ì¶”ê°€ */
        letter-spacing: 1px;  /* 2pxì—ì„œ 1pxë¡œ ì¶•ì†Œ */
        white-space: nowrap;  /* í•œ ì¤„ë¡œ ìœ ì§€ */
        overflow: hidden;  /* ë„˜ì¹˜ëŠ” í…ìŠ¤íŠ¸ ìˆ¨ê¹€ */
        text-overflow: ellipsis;  /* ... í‘œì‹œ */
    }
    
    /* ë…¸ë˜ ì œëª©ì´ ìˆ¨ê²¨ì¡Œì„ ë•Œë„ ì¤‘ì•™ ìœ ì§€ */
    #songInfo.hidden {
        transform: translateX(-50%) translateY(-20px);
    }
    
    /* ê¸°ì¡´ ìº”ë²„ìŠ¤ scale ì œê±° */
    #canvas {
        /* transform: scale(1.4); ì œê±° */
    }
}

@media (max-width: 768px) {
    #menuBtn {
        display: block;
        top: 70px;  /* ì¶”ê°€ */
    }
    
    #togglePlaylistBtn,
    #createQueueBtn,
    #speedControlBtn {
        display: none !important;
    }
    
    /* ìº”ë²„ìŠ¤ í™•ëŒ€ ì œê±° */
    /* #canvas {
        transform: scale(1.4);
        transform-origin: center;
    } */
    
    /* í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìˆ˜ì • */
    #playlist {
        max-height: 50px;  /* 40pxì—ì„œ 50pxë¡œ */
        padding: 8px 10px;  /* 5px 10pxì—ì„œ ë³€ê²½ */
    }
    

    .playlist-item {
        padding: 6px 12px;  /* 5px 10pxì—ì„œ ë³€ê²½ */
        font-size: 0.65em;  /* 0.75emì—ì„œ ë” ì‘ê²Œ */
    }
    
    /* ë…¸ë˜ ì œëª© */
    #songInfo {
        font-size: 0.85em;  /* 1emì—ì„œ ì¶•ì†Œ */
        top: 120px;  /* 65pxì—ì„œ ì´ë™ */
        padding: 6px 12px;
        max-width: 80%;
        text-align: center;
        left: 50%;
        transform: translateX(-50%);
    }

}
    
    /* í˜„ì¬ ì¬ìƒëª©ë¡ ìµœì†Œí™” */
    #currentQueue {
        right: 10px;
        top: 10px;
        max-width: 45px;
        max-height: 45px;
        padding: 8px;
        overflow: hidden;
        border-radius: 50%;
        transition: all 0.3s;
    }
    
    #currentQueue h3 {
        font-size: 1.3em;
        margin: 0;
        white-space: nowrap;
    }
    
    #currentQueue h3::before {
        content: "ğŸ¶";
    }
    
    #currentQueue h3 span,
    #currentQueue h3 button {
        display: none;
    }
    
    #currentQueueList,
    #cancelQueueBtn {
        display: none;
    }
    
    /* í„°ì¹˜/í´ë¦­ ì‹œ í™•ì¥ */
    #currentQueue.expanded {
        max-width: 220px;
        max-height: 60vh;
        border-radius: 15px;
        padding: 15px;
    }
    
    #currentQueue.expanded h3 span,
    #currentQueue.expanded h3 button {
        display: inline;
    }
    
    #currentQueue.expanded #currentQueueList,
    #currentQueue.expanded #cancelQueueBtn {
        display: block;
    }
    
    #currentQueue.expanded h3::before {
        display: none;
    }
    
    /* í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ */
    #playlist {
        max-height: 40px;
        padding: 5px 10px;
    }
    
    .playlist-item {
        padding: 5px 10px;
        font-size: 0.75em;
    }
    
    /* ë…¸ë˜ ì œëª© */
    #songInfo {
        font-size: 1em;
        top: 65px;
        padding: 6px 12px;
        max-width: 80%;
    }
    
    /* ì•¨ë²” ì•„íŠ¸ */
    #album-art {
        width: 140px;
        height: 140px;
    }
    
       /* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ */
    #controls {
        flex-wrap: wrap;
        gap: 8px;
        bottom: 120px;
        max-width: 95%;
        justify-content: center;
    }
    
    #controls button {
        padding: 10px 15px;
        font-size: 0.9em;
        flex: 1 1 calc(50% - 8px);
        min-width: 100px;
        max-width: 160px;
    }
    
    /* í† ê¸€ ë²„íŠ¼ */
    #toggleControlsBtn {
        bottom: 195px;
        font-size: 1.2em;
    }
    
    /* í”„ë¡œê·¸ë ˆìŠ¤ ë°” */
    #progress-container {
        bottom: 70px;
        width: 90%;
    }
    
    #time-display {
        font-size: 0.8em;
    }
    
    /* ë³¼ë¥¨ ì»¨íŠ¸ë¡¤ */
    #volumeToggleBtn {
        bottom: 12px;
        right: 12px;
        width: 40px;
        height: 40px;
        font-size: 1.1em;
        padding: 8px;
    }
    
    #volumeControl {
        bottom: 60px;
        right: 12px;
        padding: 8px 12px;
    }
    
    #volumeSlider {
        width: 70px;
    }
    
    /* ëª¨ë‹¬ */
    #queueModalContent,
    #speedModalContent {
        width: 95%;
        padding: 15px;
        max-height: 85vh;
    }
    
    #queueModalContent h2,
    #speedModalContent h2 {
        font-size: 1.2em;
    }
    
    .queue-section {
        flex-direction: column;
    }
    
    .speed-options {
        flex-direction: column;
        gap: 8px;
    }
    
    .speed-option {
        padding: 15px;
    }
}

#volumeControl.show {
    display: flex;
}

#volumeIcon {
    font-size: 1.5em;
    cursor: pointer;
}

#volumeSlider {
    width: 100px;
    height: 6px;
    -webkit-appearance: none;
    appearance: none;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
    outline: none;
}

#volumeSlider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 16px;
    height: 16px;
    background: linear-gradient(135deg, #00f0ff, #667eea);
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0, 240, 255, 0.5);
}

#volumeSlider::-moz-range-thumb {
    width: 16px;
    height: 16px;
    background: linear-gradient(135deg, #00f0ff, #667eea);
    border-radius: 50%;
    cursor: pointer;
    border: none;
    box-shadow: 0 0 10px rgba(0, 240, 255, 0.5);
}

#volumeValue {
    color: white;
    font-size: 0.9em;
    min-width: 35px;
}

.current-queue-item.playing {
    background: rgba(100, 200, 100, 0.3);
    border: 1px solid rgba(100, 200, 100, 0.5);
}
        
        #songInfo {
    position: absolute;
    top: 80px;
    font-size: 2em;
    font-weight: 700;
    color: #ffffff;
    text-shadow: 
        0 0 20px rgba(255, 255, 255, 0.8),
        0 0 40px rgba(255, 255, 255, 0.5),
        0 0 60px rgba(255, 255, 255, 0.3),
        0 4px 10px rgba(0, 0, 0, 0.8);
    z-index: 10;
    letter-spacing: 2px;
    text-transform: uppercase;
    background: linear-gradient(135deg, #ffffff 0%, #cccccc 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: glow 2s ease-in-out infinite alternate;
    padding: 10px 30px;
    border-radius: 50px;
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.2);
     cursor: pointer; 
}

@keyframes glow {
    from {
        filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
    }
    to {
        filter: drop-shadow(0 0 30px rgba(255, 255, 255, 0.8));
    }
}

#currentQueue {
    position: fixed;
    right: 20px;
    top: 80px;
    background: rgba(30, 30, 30, 0.9);
    padding: 15px;
    border-radius: 15px;
    border: 2px solid rgba(100, 150, 255, 0.3);
    max-width: 250px;
    max-height: 70vh; /* ìµœëŒ€ ë†’ì´ ì¶”ê°€ */
    overflow-y: auto; /* ìŠ¤í¬ë¡¤ ì¶”ê°€ */
    z-index: 90;
    display: none;
}

#currentQueue.show {
    display: block;
}

#currentQueue h3 {
    color: white;
    margin-bottom: 10px;
    font-size: 0.9em;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.current-queue-item {
    padding: 8px;
    margin: 5px 0;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 5px;
    font-size: 0.85em;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.current-queue-item.playing {
    background: rgba(100, 200, 100, 0.3);
    border: 1px solid rgba(100, 200, 100, 0.5);
}

/* ì¬ìƒëª©ë¡ ì·¨ì†Œ ë²„íŠ¼ */
#cancelQueueBtn {
    background: rgba(255, 100, 100, 0.3);
    border: 1px solid rgba(255, 100, 100, 0.5);
    color: white;
    padding: 8px 15px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.85em;
    margin-top: 10px;
    width: 100%;
    transition: all 0.3s;
    font-weight: bold;
}

#cancelQueueBtn:hover {
    background: rgba(255, 100, 100, 0.5);
    border-color: rgba(255, 100, 100, 0.8);
    transform: scale(1.02);
}

/* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
#currentQueue::-webkit-scrollbar {
    width: 6px;
}

#currentQueue::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 3px;
}

#currentQueue::-webkit-scrollbar-thumb {
    background: rgba(100, 150, 255, 0.5);
    border-radius: 3px;
}

#currentQueue::-webkit-scrollbar-thumb:hover {
    background: rgba(100, 150, 255, 0.7);
}

#songInfo.hidden {
    opacity: 0;
   
    transform: translateY(-20px);
}

#toggleControlsBtn {
    position: absolute;
    bottom: 170px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 50;
    padding: 8px 20px;
    background: transparent;  /* íˆ¬ëª… ë°°ê²½ */
    border: none;  /* í…Œë‘ë¦¬ ì œê±° */
    color: white;
    cursor: pointer;
    font-size: 1.5em;  /* í™”ì‚´í‘œ í¬ê¸° í‚¤ì›€ */
    transition: all 0.3s;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);  /* ì€ì€í•œ ê·¸ë¦¼ì */
}

#toggleControlsBtn:hover {
    transform: translateX(-50%) scale(1.2);  /* í˜¸ë²„ì‹œ í™•ëŒ€ */
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
}

#controls {
    position: absolute;
    bottom: 100px;
    display: flex;
    gap: 15px;
    z-index: 10;
    transition: transform 0.3s, opacity 0.3s;
}

#controls.hidden {
    transform: translateY(150px);
    opacity: 0;
    pointer-events: none;
}

#progress-container {
    position: absolute;
    bottom: 50px;
    width: 80%;
    max-width: 800px;
    z-index: 10;
    transition: transform 0.3s, opacity 0.3s;
}

#queueModalContent {
    background: rgba(30, 30, 30, 0.95);
    padding: 30px;
    border-radius: 20px;
    width: 90%;
    max-width: 1000px; /* ë„“ì´ ì¦ê°€ */
    max-height: 85vh; /* ë†’ì´ ì œí•œ */
    border: 2px solid rgba(255, 255, 255, 0.2);
    display: flex;
    flex-direction: column;
}

#queueModalContent h2 {
    margin-bottom: 20px;
    color: white;
    text-align: center;
    flex-shrink: 0; /* ì œëª©ì€ ê³ ì • */
}

.queue-section {
    display: flex;
    gap: 20px;
    flex: 1; /* ë‚¨ì€ ê³µê°„ ëª¨ë‘ ì‚¬ìš© */
    min-height: 0; /* ì¤‘ìš”: flex ìì‹ì´ overflow ë˜ë„ë¡ */
}

.available-songs, .selected-queue {
    flex: 1;
    background: rgba(255, 255, 255, 0.05);
    padding: 15px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    flex-direction: column;
    min-height: 0; /* ì¤‘ìš” */
}

.available-songs h3, .selected-queue h3 {
    color: white;
    margin-bottom: 10px;
    font-size: 1em;
    flex-shrink: 0;
}

/* ìŠ¤í¬ë¡¤ ì˜ì—­ ì¶”ê°€ */
#availableSongsList, #selectedQueueList {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding-right: 5px;
}

/* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
#availableSongsList::-webkit-scrollbar,
#selectedQueueList::-webkit-scrollbar {
    width: 8px;
}

#availableSongsList::-webkit-scrollbar-track,
#selectedQueueList::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
}

#availableSongsList::-webkit-scrollbar-thumb,
#selectedQueueList::-webkit-scrollbar-thumb {
    background: rgba(100, 200, 255, 0.5);
    border-radius: 4px;
}

#availableSongsList::-webkit-scrollbar-thumb:hover,
#selectedQueueList::-webkit-scrollbar-thumb:hover {
    background: rgba(100, 200, 255, 0.7);
}

.queue-loop-option {
    background: rgba(255, 255, 255, 0.05);
    padding: 15px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    margin-top: 15px; /* ìœ„ìª½ ì—¬ë°± */
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    transition: all 0.3s;
    flex-shrink: 0; /* ê³ ì • í¬ê¸° */
}

.queue-buttons {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 15px;
    flex-shrink: 0; /* ê³ ì • í¬ê¸° */
}

.queue-loop-option {
    background: rgba(255, 255, 255, 0.05);
    padding: 15px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    transition: all 0.3s;
}

/* ì•¨ë²” ì¹´ë“œ ìŠ¤íƒ€ì¼ */
.album-card {
    background: rgba(30, 30, 30, 0.8);
    border: 2px solid rgba(100, 200, 255, 0.3);
    border-radius: 15px;
    padding: 15px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
}

.album-card:hover {
    transform: translateY(-10px);
    border-color: rgba(100, 200, 255, 0.8);
    box-shadow: 0 10px 30px rgba(100, 200, 255, 0.4);
    background: rgba(40, 40, 40, 0.9);
}

.album-card-icon {
    width: 100%;
    aspect-ratio: 1;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid rgba(100, 200, 255, 0.5);
    margin-bottom: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    transition: all 0.3s;
}

/* ê¸°ì¡´ì˜ position: fixed ìŠ¤íƒ€ì¼ ì™„ì „íˆ ì‚­ì œí•˜ê³  ì•„ë˜ë¡œ êµì²´ */
#viewAllSongsBtn {
    padding: 8px 15px;
    background: rgba(100, 200, 255, 0.3);
    border: 2px solid rgba(100, 200, 255, 0.5);
    color: white;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.9em;
    transition: all 0.3s;
    white-space: nowrap;
    flex-shrink: 0;
    /* position ì†ì„± ì—†ìŒ - í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ íë¦„ì— ë”°ë¼ ë°°ì¹˜ë¨ */
}

#viewAllSongsBtn:hover {
    background: rgba(100, 200, 255, 0.5);
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(100, 200, 255, 0.4);
}

/* ëª¨ë°”ì¼ ìµœì í™” */
@media (max-width: 768px) {
    #viewAllSongsBtn {
        padding: 6px 12px;
        font-size: 0.75em;
    }
}

.album-card:hover .album-card-icon {
    transform: rotate(360deg);
    box-shadow: 0 5px 25px rgba(100, 200, 255, 0.7);
}

.album-card-title {
    color: white;
    font-size: 0.95em;
    font-weight: bold;
    margin-bottom: 8px;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
}

.album-card-play {
    background: rgba(100, 200, 255, 0.3);
    border: 1px solid rgba(100, 200, 255, 0.5);
    color: white;
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 0.85em;
    margin-top: 10px;
    transition: all 0.3s;
}

.album-card:hover .album-card-play {
    background: rgba(100, 200, 255, 0.6);
    transform: scale(1.05);
}

#skullEffectBtn {
    position: fixed;
    bottom: 20px;
    right: 80px;
    z-index: 100;
    padding: 15px;
    background: rgba(30, 30, 30, 0.9);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.5em;
    transition: all 0.3s;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
}

#skullEffectBtn:hover {
    background: rgba(50, 50, 50, 0.9);
    transform: scale(1.1);
}

#skullCanvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

/* ëª¨ë°”ì¼ ìµœì í™” */
@media (max-width: 768px) {
    #allSongsGrid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)) !important;
        gap: 15px !important;
    }
    
    .album-card {
        padding: 10px;
    }
    
    .album-card-title {
        font-size: 0.8em;
    }
}

#viewAllSongsBtn {
    transition: all 0.3s;
    flex-shrink: 0;  /* ë²„íŠ¼ì´ ì¤„ì–´ë“¤ì§€ ì•Šë„ë¡ */
}

#viewAllSongsBtn:hover {
    background: rgba(100, 200, 255, 0.5);
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(100, 200, 255, 0.4);
}

/* ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ í¬ê¸° ì¡°ì • */
@media (max-width: 768px) {
    #viewAllSongsBtn {
        padding: 6px 12px;
        font-size: 0.75em;
    }
}

.queue-loop-option:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(100, 200, 255, 0.3);
}

.queue-loop-option input[type="checkbox"] {
    width: 24px;
    height: 24px;
    cursor: pointer;
    accent-color: #64c8ff;
}

.queue-loop-label {
    color: white;
    font-size: 1.1em;
    cursor: pointer;
    user-select: none;
    flex: 1;
}

.queue-loop-icon {
    font-size: 1.5em;
}


#progress-container.hidden {
    transform: translateY(100px);
    opacity: 0;
    pointer-events: none;
}

/* ê¸°ë³¸ì€ ë³´ì„ */
#togglePlaylistBtn,
#createQueueBtn,
#speedControlBtn {
    display: block;  /* ë˜ëŠ” inline-block */
}

/* ëª¨ë°”ì¼ì—ì„œë§Œ ìˆ¨ê¹€ */
@media (max-width: 768px) {
    #togglePlaylistBtn,
    #createQueueBtn,
    #speedControlBtn {
        display: none !important;
    }
    
    #menuBtn {
        display: block;
    }
}

/* ê¸°ì¡´ #speedModalContent ìˆ˜ì • */
#speedModalContent {
    background: rgba(30, 30, 30, 0.95);
    padding: 30px;
    border-radius: 20px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    text-align: center;
    min-width: 350px;
}

/* íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.modal-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 25px;
    border-bottom: 2px solid rgba(255, 255, 255, 0.1);
    padding-bottom: 10px;
}

.modal-tab {
    flex: 1;
    padding: 12px 20px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.6);
    border-radius: 10px;
    cursor: pointer;
    font-size: 1em;
    transition: all 0.3s;
    font-weight: bold;
}

.modal-tab:hover {
    background: rgba(255, 255, 255, 0.1);
}

.modal-tab.active {
    background: rgba(100, 200, 255, 0.3);
    border-color: rgba(100, 200, 255, 0.8);
    color: white;
    box-shadow: 0 0 15px rgba(100, 200, 255, 0.4);
}

/* íƒ­ ì»¨í…ì¸  */
.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.3s;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ì´í™íŠ¸ ì˜µì…˜ ìŠ¤íƒ€ì¼ (ì†ë„ ì˜µì…˜ê³¼ ë™ì¼í•˜ê²Œ) */
.effect-options {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 20px;
}

.effect-option {
    padding: 20px 15px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 15px;
    width: 100%;
}

.effect-option:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(5px);
}

.effect-option.active {
    background: rgba(200, 100, 255, 0.3);
    border-color: rgba(200, 100, 255, 0.8);
    box-shadow: 0 0 20px rgba(200, 100, 255, 0.5);
}

.effect-icon {
    font-size: 2em;
    flex-shrink: 0;
}

/* Slowed ë²„íŠ¼ - í•‘í¬ìƒ‰ */
#slowedBtn.active {
    background: rgba(255, 150, 200, 0.3);
    border-color: rgba(255, 150, 200, 0.8);
    box-shadow: 0 0 20px rgba(255, 150, 200, 0.5);
}

#slowedBtn.active:hover {
    background: rgba(255, 150, 200, 0.4);
}

/* Super Slowed - ë¹¨ê°„ìƒ‰ */
#slowedBtn.active.super {
    background: rgba(255, 50, 50, 0.4);
    border-color: rgba(255, 50, 50, 0.9);
    box-shadow: 0 0 25px rgba(255, 50, 50, 0.7);
    animation: superPulse 1.5s ease-in-out infinite;
}

/* Sped Up ë²„íŠ¼ - í•˜ëŠ˜ìƒ‰ */
#spedUpBtn.active {
    background: rgba(100, 200, 255, 0.3);
    border-color: rgba(100, 200, 255, 0.8);
    box-shadow: 0 0 20px rgba(100, 200, 255, 0.5);
}

#spedUpBtn.active:hover {
    background: rgba(100, 200, 255, 0.4);
}

/* Super Sped Up - íŒŒë€ìƒ‰ */
#spedUpBtn.active.super {
    background: rgba(50, 100, 255, 0.4);
    border-color: rgba(50, 100, 255, 0.9);
    box-shadow: 0 0 25px rgba(50, 100, 255, 0.7);
    animation: superPulse 1.5s ease-in-out infinite;
}

/* Super í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ */
@keyframes superPulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.02);
    }
}

/* ë°°ê²½ ìƒ‰ìƒ ì˜¤ë²„ë ˆì´ */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
    transition: background 0.5s ease;
}

/* Slowed - í•‘í¬ ì˜¤ë²„ë ˆì´ */
body.speed-slowed::before {
    background: radial-gradient(circle at center, rgba(255, 150, 200, 0.15) 0%, transparent 70%);
}

/* Super Slowed - ë¹¨ê°„ ì˜¤ë²„ë ˆì´ */
body.speed-super-slowed::before {
    background: radial-gradient(circle at center, rgba(255, 50, 50, 0.25) 0%, transparent 70%);
    animation: redPulse 2s ease-in-out infinite;
}

/* Sped Up - í•˜ëŠ˜ ì˜¤ë²„ë ˆì´ */
body.speed-spedup::before {
    background: radial-gradient(circle at center, rgba(100, 200, 255, 0.15) 0%, transparent 70%);
}

/* Super Sped Up - íŒŒë€ ì˜¤ë²„ë ˆì´ */
body.speed-super-spedup::before {
    background: radial-gradient(circle at center, rgba(50, 100, 255, 0.25) 0%, transparent 70%);
    animation: bluePulse 2s ease-in-out infinite;
}

/* í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ */
@keyframes redPulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.7;
    }
}

@keyframes bluePulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.7;
    }
}

/* Normal ë²„íŠ¼ì€ ê¸°ì¡´ ìƒ‰ìƒ ìœ ì§€ */
#normalSpeedBtn.active {
    background: rgba(15, 255, 175, 0.3);
    border-color: rgba(0, 255, 213, 0.8);
    box-shadow: 0 0 20px rgba(100, 200, 255, 0.5);
}

.effect-info {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    flex: 1;
}

.effect-name {
    font-size: 1.1em;
    font-weight: bold;
    color: white;
}

.effect-value {
    font-size: 0.85em;
    color: rgba(255, 255, 255, 0.6);
}

/* Super ëª¨ë“œ í‘œì‹œ */
.speed-option.super .speed-name::before,
.effect-option.super .effect-name::before {
    content: "(SUPER) ";
    color: #ffcc00;
}

/* ëª¨ë°”ì¼ ìµœì í™” */
@media (max-width: 768px) {
    #speedModalContent {
        padding: 20px 15px;
        width: 90%;
        max-width: 400px;
        min-width: auto;
    }
    
    #speedModalContent h2 {
        font-size: 1.5em;
        margin-bottom: 20px;
    }
    
    .modal-tabs {
        gap: 8px;
    }
    
    .modal-tab {
        padding: 10px 15px;
        font-size: 0.9em;
    }
    
    .speed-option,
    .effect-option {
        padding: 15px 12px;
    }
    
    .speed-icon,
    .effect-icon {
        font-size: 1.8em;
    }
}


    </style>
</head>
<body>
    <button id="menuBtn">â˜°</button>
<div id="menuPanel">
    <button id="togglePlaylistBtn2">â–¼ ë…¸ë˜ ëª©ë¡</button>
    <button id="createQueueBtn2">ì¬ìƒëª©ë¡ ë§Œë“¤ê¸°</button>
<button id="speedControlBtn2">âš™ ë…¸ë˜ ì¡°ì •</button>
        <button id="toggleControlsBtn2">â–¼ ì»¨íŠ¸ë¡¤ ìˆ¨ê¸°ê¸°/ë³´ì´ê¸°</button>
    </div>

<button id="togglePlaylistBtn">â–¼ ë…¸ë˜ ëª©ë¡</button>
<button id="createQueueBtn">ì¬ìƒëª©ë¡ ë§Œë“¤ê¸°</button>
<button id="speedControlBtn">âš™ ë…¸ë˜ ì¡°ì •</button>
    
    <div id="playlist">

            <button id="viewAllSongsBtn">ì „ì²´ ë³´ê¸°</button>
        <!-- 
        === ë…¸ë˜ ì¶”ê°€ ë°©ë²• ===
        ì•„ë˜ í˜•ì‹ìœ¼ë¡œ ì¶”ê°€í•˜ì„¸ìš”:
        <div class="playlist-item" data-src="íŒŒì¼ëª….mp3" data-icon="ì•„ì´ì½˜íŒŒì¼ëª….png">ë…¸ë˜ ì œëª©</div>
        MONTAGEM RUGADA
        ì˜ˆì‹œ:MONTAGEM DIRECAONADA NADA
        <div class="playlist-item" data-src="song1.mp3" data-icon="song1.png">My Song 1</div>
        <div class="playlist-item" data-src="song2.mp3" data-icon="song2.jpg">My Song 2</div>
        <div class="playlist-item" data-src="music.mp3" data-icon="music.png">Cool Music</div>MONTAGEM XONADAMONTAGEM MIAU
        -->
<div class="playlist-item" data-src="ACELERADA.mp3" data-icon="ACELERADA.jpeg">ACELERADA</div>
<div class="playlist-item" data-src="AL NACER.mp3" data-icon="AL NACER.jpeg">AL NACER</div>
<div class="playlist-item" data-src="BAILÃƒO.mp3" data-icon="BAILÃƒO.jpeg">BAILÃƒO</div>
<div class="playlist-item" data-src="CANTO DE LUNA.mp3" data-icon="CANTO DE LUNA.jpeg">CANTO DE LUNA</div>

<div class="playlist-item" data-src="CONFESS YOUR LOVE.mp3" data-icon="CONFESS YOUR LOVE.jpeg">CONFESS YOUR LOVE</div>
         <div class="playlist-item" data-src="DIA DELIÌCIA.mp3" data-icon="DIA DELIÌCIA.jpeg">DIA DELIÌCIA</div><div class="playlist-item" data-src="LUA NA PRAA.mp3" data-icon="LUA NA PRAA.jpeg">LUA NA PRAA</div>
           <div class="playlist-item" data-src="MENTE MAÌ.mp3" data-icon="MENTE MAÌ.jpeg">MENTE MAÌ</div><div class="playlist-item" data-src="MONTAGEM BANDIDO.mp3" data-icon="MONTAGEM BANDIDO.jpeg">MONTAGEM BANDIDO</div>
<div class="playlist-item" data-src="MONTAGEM BATCHI.mp3" data-icon="MONTAGEM BATCHI.jpeg">MONTAGEM BATCHI</div>
<div class="playlist-item" data-src="MONTAGEM DIRECAO.mp3" data-icon="MONTAGEM DIRECAO.jpeg">MONTAGEM DIRECAO</div>
<div class="playlist-item" data-src="MONTAGEM MIAU.mp3" data-icon="MONTAGEM MIAU.jpeg">MONTAGEM MIAU</div>
<div class="playlist-item" data-src="MONTAGEM RUGADA.mp3" data-icon="MONTAGEM RUGADA.jpeg">MONTAGEM RUGADA</div>
<div class="playlist-item" data-src="MONTAGEM SUPERSONIC.mp3" data-icon="MONTAGEM SUPERSONIC.jpeg">MONTAGEM SUPERSONIC</div>
<div class="playlist-item" data-src="MONTAGEM TOMADA.mp3" data-icon="MONTAGEM TOMADA.jpeg">MONTAGEM TOMADA</div>

<div class="playlist-item" data-src="MONTAGEM XONADA.mp3" data-icon="MONTAGEM XONADA.jpeg">MONTAGEM XONADA</div>
<div class="playlist-item" data-src="NADA NADA.mp3" data-icon="NADA NADA.jpeg">NADA NADA</div>
<div class="playlist-item" data-src="NO BATIDÃƒO .mp3" data-icon="NO BATIDÃƒO .png">NO BATIDÃƒO</div>
<div class="playlist-item" data-src="PASSO BEM SOLTO.mp3" data-icon="PASSO BEM SOLTO.jpeg">PASSO BEM SOLTO</div>
<div class="playlist-item" data-src="SAFADO NO BAILO.mp3" data-icon="SAFADO NO BAILO.jpeg">SAFADO NO BAILO</div>

<div class="playlist-item" data-src="VAI VAI TRAIR.mp3" data-icon="VAI VAI TRAIR.jpeg">VAI VAI TRAIR</div>
<div class="playlist-item" data-src="VEM NO PIQUE.mp3" data-icon="VEM NO PIQUE.jpeg">VEM NO PIQUE</div>
<div class="playlist-item" data-src="VEM VEM.mp3" data-icon="VEM VEM.jpeg">VEM VEM</div>
<div class="playlist-item" data-src="YOSHO HAI MONTAGEM.mp3" data-icon="YOSHO HAI MONTAGEM.jpeg">YOSHO HAI MONTAGEM</div>


    <!-- ê¸°ì¡´ ë…¸ë˜ ëª©ë¡ë“¤... -->
    <button id="playlistScrollRight" style="position: sticky; right: 0; background: rgba(20,20,20,0.95); border: none; color: white; padding: 10px; cursor: pointer; font-size: 1.2em;">â€º</button>
        </div>



        <div id="allSongsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.95); z-index: 300; overflow-y: auto;">
    <div style="max-width: 1200px; margin: 0 auto; padding: 40px 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
            <h2 style="color: white; font-size: 2em; text-shadow: 0 0 20px rgba(100, 200, 255, 0.5);">ğŸ“€_LIST_ğŸ“€</h2>
            <button id="closeAllSongsBtn" style="background: rgba(255, 100, 100, 0.3); border: 2px solid rgba(255, 100, 100, 0.5); color: white; padding: 12px 25px; border-radius: 10px; cursor: pointer; font-size: 1.1em;">âœ• ë‹«ê¸°</button>
        </div>
        <div id="allSongsGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 25px;"></div>
    </div>
</div>

    <div id="container">
       <img id="album-bg" src="" alt="Background">
        <canvas id="canvas"></canvas>
        <canvas id="skullCanvas"></canvas>
        <img id="album-art" src="" alt="Album Art">
        <div id="songInfo">ë…¸ë˜ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
        <button id="toggleControlsBtn">â–¼</button>
        <div id="controls">
            <button id="stopBtn">â—¼ ì •ì§€</button>
            <button id="prevBtn">â® -10ì´ˆ</button>
  
            <button id="playBtn">â–¶ ì¬ìƒ</button>
            <button id="pauseBtn" style="display:none;">âšâš ì¼ì‹œì •ì§€</button>
            <button id="nextBtn">â­ +10ì´ˆ</button>
              <button id="loopBtn">â†º ë°˜ë³µ</button> 
        </div>
 <button id="volumeToggleBtn">ğŸ”Š</button>
<!-----<button id="skullEffectBtn">?</button>
    -->
<div id="volumeControl">
    <span id="volumeIcon">ğŸ”Š</span>
    <input type="range" id="volumeSlider" min="0" max="100" value="100">
    <span id="volumeValue">100</span>
</div>
        <div id="progress-container">
            <div id="progress-bar">
                <div id="progress-fill"></div>
            </div>
            <div id="time-display">
                <span id="current-time">0:00</span>
                <span id="total-time">0:00</span>
            </div>
        </div>
    </div>

    <audio id="audio" crossorigin="anonymous"></audio>

    <div id="queueModal">
    <div id="queueModalContent">
        <h2>ğŸµ ì¬ìƒëª©ë¡ ë§Œë“¤ê¸° (ìµœëŒ€ 8ê°œ)</h2>
        <div class="queue-section">
            <div class="available-songs">
                <h3>ì‚¬ìš© ê°€ëŠ¥í•œ ë…¸ë˜</h3>
                <div id="availableSongsList"></div>
            </div>
            <div class="selected-queue">
                <h3>ì„ íƒí•œ ì¬ìƒëª©ë¡</h3>
                <div id="selectedQueueList"></div>
            </div>
            </div>
           <div class="queue-loop-option" id="queueLoopOption">
            <input type="checkbox" id="queueLoopCheckbox">
            <label class="queue-loop-label" for="queueLoopCheckbox">
                ì¬ìƒëª©ë¡ ë°˜ë³µ ì¬ìƒ
            </label>
            <span class="queue-loop-icon">â†º</span>
        </div>
        
        <div class="queue-buttons">
            <button id="startQueueBtn">â–¶ ì¬ìƒ ì‹œì‘</button>
            <button id="closeQueueBtn">X ë‹«ê¸°</button>
        </div>
    </div>
</div>


<!-- ê¸°ì¡´ speedModalì„ ì°¾ì•„ì„œ í†µì§¸ë¡œ êµì²´ -->
<div id="speedModal">
    <div id="speedModalContent">
        <h2>âš™ ë…¸ë˜ ì¡°ì •</h2>
        
        <!-- íƒ­ ë²„íŠ¼ -->
        <div class="modal-tabs">
            <button id="speedTab" class="modal-tab active">+ ì†ë„</button>
            <button id="effectTab" class="modal-tab">â˜… ì´í™íŠ¸</button>
        </div>
        
        <!-- ì†ë„ ì¡°ì ˆ íƒ­ -->
        <div id="speedTabContent" class="tab-content active">
            <div class="speed-options">
                <button id="slowedBtn" class="speed-option">
                    <span class="speed-icon">â¬‡</span>
                    <div class="speed-info">
                        <span class="speed-name">Slowed</span>
                        <span class="speed-value">0.9x</span>
                    </div>
                </button>
                
                <button id="normalSpeedBtn" class="speed-option active">
                    <span class="speed-icon">â—</span>
                    <div class="speed-info">
                        <span class="speed-name">Normal</span>
                        <span class="speed-value">1.0x</span>
                    </div>
                </button>
                
                <button id="spedUpBtn" class="speed-option">
                    <span class="speed-icon">â¬†</span>
                    <div class="speed-info">
                        <span class="speed-name">Sped Up</span>
                        <span class="speed-value">1.1x</span>
                    </div>
                </button>
            </div>
            <p style="color: rgba(255,255,255,0.6); font-size: 0.85em; margin-top: 15px;">
               
            </p>
             <button id="closeSpeedBtn" class="modal-close-btn">âœ• ë‹«ê¸°</button>
        </div>
        
        <!-- ì´í™íŠ¸ íƒ­ -->
  <div id="effectTabContent" class="tab-content">
    <div style="background: rgba(255, 200, 100, 0.2); border: 2px solid rgba(255, 200, 100, 0.5); border-radius: 10px; padding: 15px; margin-bottom: 20px;">
        <p style="color: white; font-size: 1em; margin: 0;">
             <strong>ì—…ë°ì´íŠ¸ ë³´ë¥˜ ì¤‘</strong> <br>
            <span style="font-size: 0.85em; opacity: 0.8;">ì´í™íŠ¸ ê¸°ëŠ¥ì´ ê°œì„  ì¤‘ì…ë‹ˆë‹¤</span>
        </p>
    </div>
           
        
        <button id="closeSpeedBtn" class="modal-close-btn">âœ• ë‹«ê¸°</button>
    </div>
</div>




</div>


<div id="currentQueue">
    <h3>
        í˜„ì¬ ì¬ìƒëª©ë¡
        <span style="font-size: 0.8em; opacity: 0.7;" id="queueCounter">0/0</span>
        <button id="toggleQueueDisplayBtn" style="background: none; border: none; color: white; cursor: pointer; font-size: 1.2em; padding: 0; margin-left: 10px;">â–¼</button>
    </h3>
    <div id="currentQueueList"></div>
    <button id="cancelQueueBtn">âŒ ì¬ìƒëª©ë¡ ì·¨ì†Œ</button>
</div>

<audio id="audio" crossorigin="anonymous"></audio>

    <script>
        const canvas = document.getElementById('canvas');
        const loopBtn = document.getElementById('loopBtn');
        const ctx = canvas.getContext('2d');
        const toggleQueueDisplayBtn = document.getElementById('toggleQueueDisplayBtn');
let queueContentVisible = true;
        const albumBg = document.getElementById('album-bg');
        const audio = document.getElementById('audio');
        const playBtn = document.getElementById('playBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const stopBtn = document.getElementById('stopBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const songInfo = document.getElementById('songInfo');
        const albumArt = document.getElementById('album-art');
        const progressBar = document.getElementById('progress-bar');
        const progressFill = document.getElementById('progress-fill');
        const currentTimeEl = document.getElementById('current-time');
        const totalTimeEl = document.getElementById('total-time');
        const togglePlaylistBtn = document.getElementById('togglePlaylistBtn');
        const playlistDiv = document.getElementById('playlist');
        const createQueueBtn = document.getElementById('createQueueBtn');
        const speedControlBtn = document.getElementById('speedControlBtn');
const speedModal = document.getElementById('speedModal');
const closeSpeedBtn = document.getElementById('closeSpeedBtn');
const queueModal = document.getElementById('queueModal');
const closeQueueBtn = document.getElementById('closeQueueBtn');
const startQueueBtn = document.getElementById('startQueueBtn');
const availableSongsList = document.getElementById('availableSongsList');
const selectedQueueList = document.getElementById('selectedQueueList');
const toggleControlsBtn = document.getElementById('toggleControlsBtn');
const controlsDiv = document.getElementById('controls');
const progressContainer = document.getElementById('progress-container');
const slowedBtn = document.getElementById('slowedBtn');
const normalSpeedBtn = document.getElementById('normalSpeedBtn');
const spedUpBtn = document.getElementById('spedUpBtn');
const volumeToggleBtn = document.getElementById('volumeToggleBtn');
const volumeControl = document.getElementById('volumeControl');
const volumeSlider = document.getElementById('volumeSlider');
const volumeValue = document.getElementById('volumeValue');
const volumeIcon = document.getElementById('volumeIcon');
const currentQueueDiv = document.getElementById('currentQueue');
const currentQueueList = document.getElementById('currentQueueList');
const cancelQueueBtn = document.getElementById('cancelQueueBtn');
const queueCounter = document.getElementById('queueCounter');
let isMuted = false;
let previousVolume = 100;
let currentSpeed = 1.0;
let isQueueLooping = false;
const queueLoopCheckbox = document.getElementById('queueLoopCheckbox');
const queueLoopOption = document.getElementById('queueLoopOption');
// í–„ë²„ê±° ë©”ë‰´ ê¸°ëŠ¥
const menuBtn = document.getElementById('menuBtn');
const menuPanel = document.getElementById('menuPanel');
const togglePlaylistBtn2 = document.getElementById('togglePlaylistBtn2');
const createQueueBtn2 = document.getElementById('createQueueBtn2');
const speedControlBtn2 = document.getElementById('speedControlBtn2');

// ì „ì²´ ë³´ê¸° ëª¨ë‹¬ ê¸°ëŠ¥
const viewAllSongsBtn = document.getElementById('viewAllSongsBtn');
const allSongsModal = document.getElementById('allSongsModal');
const closeAllSongsBtn = document.getElementById('closeAllSongsBtn');
const allSongsGrid = document.getElementById('allSongsGrid');

// ë…¸ë˜ ì¡°ì • ê´€ë ¨ ë³€ìˆ˜
const speedTab = document.getElementById('speedTab');
const effectTab = document.getElementById('effectTab');
const speedTabContent = document.getElementById('speedTabContent');
const effectTabContent = document.getElementById('effectTabContent');
const reverbBtn = document.getElementById('reverbBtn');
const bassBoostBtn = document.getElementById('bassBoostBtn');
const eightDBtn = document.getElementById('eightDBtn');
const normalEffectBtn = document.getElementById('normalEffectBtn');

let currentEffect = 'normal';
let isSuperSlowed = false;
let isSuperSpedUp = false;
let convolver, bassFilter, panner, eightDInterval;

viewAllSongsBtn.addEventListener('click', () => {
    allSongsModal.style.display = 'block';
    loadAllSongsGrid();
});

closeAllSongsBtn.addEventListener('click', () => {
    allSongsModal.style.display = 'none';
});

allSongsModal.addEventListener('click', (e) => {
    if (e.target === allSongsModal) {
        allSongsModal.style.display = 'none';
    }
});



// íƒ­ ì „í™˜
speedTab?.addEventListener('click', () => {
    speedTab.classList.add('active');
    effectTab.classList.remove('active');
    speedTabContent.classList.add('active');
    effectTabContent.classList.remove('active');
});

effectTab?.addEventListener('click', () => {
    effectTab.classList.add('active');
    speedTab.classList.remove('active');
    effectTabContent.classList.add('active');
    speedTabContent.classList.remove('active');
});
function loadAllSongsGrid() {
    allSongsGrid.innerHTML = '';
    const allSongs = document.querySelectorAll('.playlist-item');
    
    // ë…¸ë˜ ë°ì´í„° ìˆ˜ì§‘ ë° ì •ë ¬
    const songsArray = [];
    allSongs.forEach((item) => {
        songsArray.push({
            element: item,
            src: item.getAttribute('data-src'),
            icon: item.getAttribute('data-icon'),
            title: item.textContent
        });
    });
    
    // ì•ŒíŒŒë²³ìˆœ ì •ë ¬
    songsArray.sort((a, b) => a.title.localeCompare(b.title));
    
    // ëœë¤ í”Œë ˆì´ ì¹´ë“œ ë¨¼ì € ì¶”ê°€
    const randomCard = document.createElement('div');
    randomCard.className = 'album-card';
    randomCard.style.background = 'linear-gradient(135deg, rgba(255, 100, 200, 0.3), rgba(100, 200, 255, 0.3))';
    randomCard.innerHTML = `
        <div class="album-card-icon" style="display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #ff64c8, #64c8ff); font-size: 4em; border: 3px solid rgba(255, 255, 255, 0.8);">
            â‡„
        </div>
        <div class="album-card-title" style="font-size: 1.2em; color: #fff;">ëœë¤ í”Œë ˆì´</div>
        <button class="album-card-play" style="background: linear-gradient(135deg, #ff64c8, #64c8ff);">â‡„ ëœë¤ ì¬ìƒ</button>
    `;
    
    randomCard.addEventListener('click', () => {
        // ëª¨ë‹¬ ë¨¼ì € ë‹«ê¸°
        allSongsModal.style.display = 'none';
        
        // ëœë¤ ì„ íƒ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        showRandomAnimation(songsArray);
    });
    
    allSongsGrid.appendChild(randomCard);
    
    // ë‚˜ë¨¸ì§€ ë…¸ë˜ ì¹´ë“œ ìƒì„±
    songsArray.forEach((song) => {
        const card = document.createElement('div');
        card.className = 'album-card';
        
        const iconSrc = song.icon || 'default-album.png';
        
        card.innerHTML = `
            <img src="${iconSrc}" class="album-card-icon" alt="${song.title}" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22%3E%3Ccircle cx=%2250%22 cy=%2250%22 r=%2240%22 fill=%22%2333333%22/%3E%3Ctext x=%2250%22 y=%2255%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2220%22%3EğŸµ%3C/text%3E%3C/svg%3E'">
            <div class="album-card-title">${song.title}</div>
            <button class="album-card-play">â–¶ ì¬ìƒ</button>
        `;
        
        card.addEventListener('click', () => {
            loadSong(song.element);
            allSongsModal.style.display = 'none';
        });
        
        allSongsGrid.appendChild(card);
    });
}

function showRandomAnimation(songsArray) {
    // ë…¸ë˜ ì œëª©ì„ ë¹ ë¥´ê²Œ ë°”ê¾¸ëŠ” ì• ë‹ˆë©”ì´ì…˜
    songInfo.style.fontSize = '3em';
    songInfo.style.transition = 'none';
    
    let counter = 0;
    const maxCount = 20; // 20ë²ˆ ëŒë¦¬ê¸°
    const interval = setInterval(() => {
        const randomIndex = Math.floor(Math.random() * songsArray.length);
        songInfo.textContent = 'â‡„ ' + songsArray[randomIndex].title;
        songInfo.style.color = `hsl(${Math.random() * 360}, 100%, 70%)`;
        counter++;
        
        if (counter >= maxCount) {
            clearInterval(interval);
            // ìµœì¢… ì„ íƒ
            const finalIndex = Math.floor(Math.random() * songsArray.length);
            const finalSong = songsArray[finalIndex];
            
            songInfo.style.color = '#00ff00';
            songInfo.textContent = 'âœ“ ' + finalSong.title;
            
            setTimeout(() => {
                songInfo.style.fontSize = '2em';
                songInfo.style.transition = 'all 0.3s';
                
                // elementê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ì§ì ‘ ë¡œë“œ
                if (finalSong.element) {
                    loadSong(finalSong.element);
                } else {
                    // ì§ì ‘ ë…¸ë˜ ë¡œë“œ
                    currentSong = finalSong;
                    audio.src = finalSong.src;
                    audio.playbackRate = currentSpeed;
                    audio.preservesPitch = (currentSpeed === 1.0);
                    songInfo.textContent = finalSong.title;
                    
                    if (finalSong.icon) {
                        albumArt.src = finalSong.icon;
                        albumArt.classList.add('show');
                        albumBg.src = finalSong.icon;
                        albumBg.classList.add('show');
                    }
                    
                    setupAudio();
                    audio.play();
                    isPlaying = true;
                    visualize();
                    playBtn.style.display = 'none';
                    pauseBtn.style.display = 'inline-block';
                }
            }, 1000);
        }
    }, 100);
}





// ì»¨íŠ¸ë¡¤ ìˆ¨ê¸°ê¸°/ë³´ì´ê¸°
let controlsVisible = true;
toggleControlsBtn.addEventListener('click', () => {
    controlsVisible = !controlsVisible;
    if (controlsVisible) {
        controlsDiv.classList.remove('hidden');
        progressContainer.classList.remove('hidden');
        toggleControlsBtn.textContent = 'â–¼';
        toggleControlsBtn.style.bottom = '170px';
    } else {
        controlsDiv.classList.add('hidden');
        progressContainer.classList.add('hidden');
        toggleControlsBtn.textContent = 'â–²';
        toggleControlsBtn.style.bottom = '20px';
    }
});

let playQueue = [];
let currentQueueIndex = 0;
let isQueueMode = false;
const MAX_QUEUE = 8;

        let audioContext;
        let analyser;
        let source;
        let animationId;
        let currentSong = null;
        let isPlaying = false;
        
        // ì¬ìƒëª©ë¡ í† ê¸€
    // ì¬ìƒëª©ë¡ í† ê¸€
// ì¬ìƒëª©ë¡ í† ê¸€

const toggleControlsBtn2 = document.getElementById('toggleControlsBtn2');

toggleControlsBtn2.addEventListener('click', () => {
    toggleControlsBtn.click();  // ê¸°ì¡´ ë²„íŠ¼ ê¸°ëŠ¥ ì‹¤í–‰
    menuPanel.classList.remove('show');
});

let playlistVisible = true;
togglePlaylistBtn.addEventListener('click', () => {
    playlistVisible = !playlistVisible;
    if (playlistVisible) {
        playlistDiv.classList.remove('hidden');
        togglePlaylistBtn.textContent = 'â–¼ ë…¸ë˜ ëª©ë¡';
        // ë²„íŠ¼ë“¤ì„ ì›ë˜ ìœ„ì¹˜ë¡œ
        togglePlaylistBtn.style.top = '70px';
        createQueueBtn.style.top = '70px';
        speedControlBtn.style.top = '120px';
    } else {
        playlistDiv.classList.add('hidden');
        togglePlaylistBtn.textContent = 'â–² ë…¸ë˜ ëª©ë¡';
        // ë²„íŠ¼ë“¤ì„ ìœ„ë¡œ ì˜¬ë¦¼
        togglePlaylistBtn.style.top = '10px';
        createQueueBtn.style.top = '10px';
        speedControlBtn.style.top = '60px';
    }
});

if (menuBtn && menuPanel) {
    menuBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        menuPanel.classList.toggle('show');
    });

    // ë©”ë‰´ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
    document.addEventListener('click', (e) => {
        if (!menuPanel.contains(e.target) && e.target !== menuBtn) {
            menuPanel.classList.remove('show');
        }
    });

    // ê¸°ì¡´ ë²„íŠ¼ ê¸°ëŠ¥ ì—°ê²°
    togglePlaylistBtn2.addEventListener('click', () => {
        togglePlaylistBtn.click();
        menuPanel.classList.remove('show');
    });

    createQueueBtn2.addEventListener('click', () => {
        createQueueBtn.click();
        menuPanel.classList.remove('show');
    });

    speedControlBtn2.addEventListener('click', () => {
        speedControlBtn.click();
        menuPanel.classList.remove('show');
    });
}

// ì¬ìƒëª©ë¡ í„°ì¹˜ë¡œ í™•ì¥/ì¶•ì†Œ (ëª¨ë°”ì¼)
if (window.innerWidth <= 768 && currentQueueDiv) {
    currentQueueDiv.addEventListener('click', (e) => {
        if (!e.target.closest('button') && !e.target.closest('.remove-queue-btn')) {
            currentQueueDiv.classList.toggle('expanded');
        }
    });
}

toggleQueueDisplayBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    queueContentVisible = !queueContentVisible;
    
    if (queueContentVisible) {
        currentQueueList.style.display = 'block';
        cancelQueueBtn.style.display = 'block';
        toggleQueueDisplayBtn.textContent = 'â–¼';
    } else {
        currentQueueList.style.display = 'none';
        cancelQueueBtn.style.display = 'none';
        toggleQueueDisplayBtn.textContent = 'â–²';
    }
});

//const playlistScrollLeft = document.getElementById('playlistScrollLeft');
const playlistScrollRight = document.getElementById('playlistScrollRight');

//playlistScrollLeft.addEventListener('click', () => {
  //  playlistDiv.scrollBy({
    //    left: -200,
      //  behavior: 'smooth'
   /// });
/// });

playlistScrollRight.addEventListener('click', () => {
    playlistDiv.scrollBy({
        left: 200,
        behavior: 'smooth'
    });
});

// ë…¸ë˜ ì œëª© í† ê¸€
let songInfoVisible = true;
songInfo.addEventListener('click', (e) => {
    e.stopPropagation();  // ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€
    songInfoVisible = !songInfoVisible;
    if (songInfoVisible) {
        songInfo.classList.remove('hidden');
    } else {
        songInfo.classList.add('hidden');
    }
});
// í™”ë©´ ìë™ êº¼ì§ ë°©ì§€
let wakeLock = null;

// Wake Lock ìš”ì²­ í•¨ìˆ˜
async function requestWakeLock() {
    try {
        if ('wakeLock' in navigator) {
            wakeLock = await navigator.wakeLock.request('screen');
            console.log('í™”ë©´ ìë™ êº¼ì§ ë°©ì§€ í™œì„±í™”');
            
            // í™”ë©´ì´ ë‹¤ì‹œ í™œì„±í™”ë  ë•Œ ì¬ìš”ì²­
            wakeLock.addEventListener('release', () => {
                console.log('Wake Lock í•´ì œë¨');
            });
        }
    } catch (err) {
        console.log('Wake Lock ì‹¤íŒ¨:', err);
    }
}

// Wake Lock í•´ì œ í•¨ìˆ˜
function releaseWakeLock() {
    if (wakeLock !== null) {
        wakeLock.release();
        wakeLock = null;
        console.log('í™”ë©´ ìë™ êº¼ì§ ë°©ì§€ í•´ì œ');
    }
}



// ì¬ìƒëª©ë¡ ì·¨ì†Œ ë²„íŠ¼
cancelQueueBtn.addEventListener('click', () => {
    if (confirm('ì¬ìƒëª©ë¡ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        // í ëª¨ë“œ ì¢…ë£Œ
        isQueueMode = false;
        isQueueLooping = false;
        currentQueueDiv.classList.remove('show');
        
        // í˜„ì¬ ê³¡ì€ ê³„ì† ì¬ìƒ
        if (currentSong) {
             updateSongTitle(currentSong.title);
        }
        
        // ì¬ìƒëª©ë¡ ì´ˆê¸°í™”í•˜ì§€ ì•ŠìŒ (ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ìˆê²Œ)
        // playQueue = []; // ì´ ì¤„ì€ ì œê±°
        currentQueueIndex = 0;
    }
});
// ë³¼ë¥¨ ì»¨íŠ¸ë¡¤ í† ê¸€
volumeToggleBtn.addEventListener('click', () => {
    volumeControl.classList.toggle('show');
});

// ë³¼ë¥¨ ì¡°ì ˆ
volumeSlider.addEventListener('input', (e) => {
    const volume = e.target.value;
    audio.volume = volume / 100;
    volumeValue.textContent = volume;
    updateVolumeIcon(volume);
});

// ë³¼ë¥¨ ì•„ì´ì½˜ í´ë¦­ìœ¼ë¡œ ìŒì†Œê±°/í•´ì œ
volumeIcon.addEventListener('click', () => {
    if (isMuted) {
        audio.volume = previousVolume / 100;
        volumeSlider.value = previousVolume;
        volumeValue.textContent = previousVolume;
        isMuted = false;
    } else {
        previousVolume = volumeSlider.value;
        audio.volume = 0;
        volumeSlider.value = 0;
        volumeValue.textContent = 0;
        isMuted = true;
    }
    updateVolumeIcon(volumeSlider.value);
});

function updateVolumeIcon(volume) {
    if (volume == 0) {
        volumeIcon.textContent = 'ğŸ”‡';
        volumeToggleBtn.textContent = 'ğŸ”‡';
    } else if (volume < 50) {
        volumeIcon.textContent = 'ğŸ”‰';
        volumeToggleBtn.textContent = 'ğŸ”‰';
    } else {
        volumeIcon.textContent = 'ğŸ”Š';
        volumeToggleBtn.textContent = 'ğŸ”Š';
    }
}

// í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½ ì‹œ ì¬ìš”ì²­
document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'visible' && isPlaying) {
        requestWakeLock();
    }
});

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // ì¬ìƒëª©ë¡ ì•„ì´í…œ í´ë¦­ ì´ë²¤íŠ¸
        document.querySelectorAll('.playlist-item').forEach(item => {
            item.addEventListener('click', () => {
                loadSong(item);
            });
        });

        function loadSong(item) {
            const src = item.getAttribute('data-src');
            const icon = item.getAttribute('data-icon');
            const title = item.textContent;
            
            currentSong = { src, icon, title };
            audio.src = src;
             audio.playbackRate = currentSpeed; // ì¶”ê°€: í˜„ì¬ ì†ë„ ìœ ì§€
    audio.preservesPitch = (currentSpeed === 1.0);
            songInfo.textContent = title;

             updateSongTitle(title);
            
            // í™œì„± ìƒíƒœ í‘œì‹œ
            document.querySelectorAll('.playlist-item').forEach(el => el.classList.remove('active'));
            item.classList.add('active');
            
            // ì•¨ë²” ì•„íŠ¸ ë¡œë“œ
    if (icon) {
    const img = new Image();
    img.onload = () => {
        albumArt.src = icon;
        albumArt.classList.add('show');
        albumBg.src = icon;
        albumBg.classList.add('show');
    };
    img.onerror = () => {
        albumArt.classList.remove('show');
        albumBg.classList.remove('show');
    };
    img.src = icon;
} else {
    albumArt.classList.remove('show');
    albumBg.classList.remove('show');
}

   if (animationId) {
    cancelAnimationFrame(animationId);
}         
            // ìë™ ì¬ìƒ
            setupAudio();
            audio.play();
            isPlaying = true;
            visualize();
            playBtn.style.display = 'none';
            pauseBtn.style.display = 'inline-block';

            requestWakeLock();
        }

       function setupAudio() {
    if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioContext.createAnalyser();
        analyser.fftSize = 2048;
        analyser.smoothingTimeConstant = 0.7;
        analyser.minDecibels = -90; // ì¶”ê°€: ë‚®ì€ ìŒëŸ‰ë„ ê°ì§€
analyser.maxDecibels = -10;
        
        source = audioContext.createMediaElementSource(audio);
        source.connect(analyser);
        analyser.connect(audioContext.destination);
    }
    
    // AudioContextê°€ suspended ìƒíƒœë©´ resume
    if (audioContext.state === 'suspended') {
        audioContext.resume();
    }
}

// ëª¨ë‹¬ ì—´ê¸°
speedControlBtn.addEventListener('click', () => {
    speedModal.classList.add('show');
});

// ëª¨ë‹¬ ë‹«ê¸°
closeSpeedBtn.addEventListener('click', () => {
    speedModal.classList.remove('show');
});

// ëª¨ë‹¬ ë°°ê²½ í´ë¦­ì‹œ ë‹«ê¸°
speedModal.addEventListener('click', (e) => {
    if (e.target === speedModal) {
        speedModal.classList.remove('show');
    }
});

slowedBtn.addEventListener('click', () => {
    if (currentSpeed === 0.9 && !isSuperSlowed) {
        // Slowed ìƒíƒœì—ì„œ ë‹¤ì‹œ ëˆ„ë¥´ë©´ Super Slowed
        currentSpeed = 0.8;
        isSuperSlowed = true;
        slowedBtn.classList.add('super');
        slowedBtn.querySelector('.speed-value').textContent = '0.8x';
    } else {
        // ì¼ë°˜ Slowedë¡œ
        currentSpeed = 0.9;
        isSuperSlowed = false;
        isSuperSpedUp = false;
        slowedBtn.classList.remove('super');
        spedUpBtn.classList.remove('super');
        slowedBtn.querySelector('.speed-value').textContent = '0.9x';
        spedUpBtn.querySelector('.speed-value').textContent = '1.1x';
    }

      document.body.className = ''; // ê¸°ì¡´ í´ë˜ìŠ¤ ì œê±°
    if (isSuperSlowed) {
        document.body.classList.add('speed-super-slowed');
    } else {
        document.body.classList.add('speed-slowed');
    }
    
    audio.playbackRate = currentSpeed;
    audio.preservesPitch = false;
    updateSpeedButtons('slowed');
    updateSongTitle();
});

normalSpeedBtn.addEventListener('click', () => {
    currentSpeed = 1.0;
    isSuperSlowed = false;
    isSuperSpedUp = false;
    
    // Super í‘œì‹œ ì œê±°
    slowedBtn.classList.remove('super');
    spedUpBtn.classList.remove('super');
    slowedBtn.querySelector('.speed-value').textContent = '0.9x';
    spedUpBtn.querySelector('.speed-value').textContent = '1.1x';
    
    audio.playbackRate = 1.0;
    audio.preservesPitch = true;
    updateSpeedButtons('normal');
    updateSongTitle();
});

// Sped Up ë²„íŠ¼ (1.3x ì†ë„, í”¼ì¹˜ ë†’ì„)
spedUpBtn.addEventListener('click', () => {
    if (currentSpeed === 1.1 && !isSuperSpedUp) {
        // Sped Up ìƒíƒœì—ì„œ ë‹¤ì‹œ ëˆ„ë¥´ë©´ Super Sped Up
        currentSpeed = 1.2;
        isSuperSpedUp = true;
        spedUpBtn.classList.add('super');
        spedUpBtn.querySelector('.speed-value').textContent = '1.2x';
    } else {
        // ì¼ë°˜ Sped Upìœ¼ë¡œ
        currentSpeed = 1.1;
        isSuperSpedUp = false;
        isSuperSlowed = false;
        spedUpBtn.classList.remove('super');
        slowedBtn.classList.remove('super');
        spedUpBtn.querySelector('.speed-value').textContent = '1.1x';
        slowedBtn.querySelector('.speed-value').textContent = '0.9x';
    }

       document.body.className = ''; // ê¸°ì¡´ í´ë˜ìŠ¤ ì œê±°
    if (isSuperSpedUp) {
        document.body.classList.add('speed-super-spedup');
    } else {
        document.body.classList.add('speed-spedup');
    }
    
    
    audio.playbackRate = currentSpeed;
    audio.preservesPitch = false;
    updateSpeedButtons('spedup');
    updateSongTitle();
});

// ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
function updateSpeedButtons(active) {
    slowedBtn.classList.remove('active');
    normalSpeedBtn.classList.remove('active');
    spedUpBtn.classList.remove('active');
    
    if (active === 'slowed') {
        slowedBtn.classList.add('active');
    } else if (active === 'normal') {
        normalSpeedBtn.classList.add('active');
    } else if (active === 'spedup') {
        spedUpBtn.classList.add('active');
    }
}

// ì´ˆê¸° ìƒíƒœ ì„¤ì •
updateSpeedButtons('normal');

// ì•¨ë²” ì•„íŠ¸ LPíŒ íšŒì „ íš¨ê³¼
albumArt.addEventListener('mouseenter', () => {
    albumArt.classList.add('spinning');
});

albumArt.addEventListener('mouseleave', () => {
    albumArt.classList.remove('spinning');
});

        playBtn.addEventListener('click', () => {
            if (!currentSong) {
                alert('ë¨¼ì € ë…¸ë˜ ëª©ë¡ì—ì„œ ë…¸ë˜ë¥¼ ì„ íƒí•˜ì„¸ìš”!');
                return;
            }
            setupAudio();
            audio.play();
            isPlaying = true;
            visualize();
            playBtn.style.display = 'none';
            pauseBtn.style.display = 'inline-block';
            songInfo.textContent = 'ğŸ¶ ' + currentSong.title;

            requestWakeLock();
        });

        pauseBtn.addEventListener('click', () => {
            audio.pause();
            isPlaying = false;
            playBtn.style.display = 'inline-block';
            pauseBtn.style.display = 'none';
            songInfo.textContent = 'â¸ ' + currentSong.title;

            requestWakeLock();
        });

        stopBtn.addEventListener('click', () => {
            audio.pause();
            audio.currentTime = 0;
            isPlaying = false;
            playBtn.style.display = 'inline-block';
            pauseBtn.style.display = 'none';
            songInfo.textContent = 'â¹ ' + currentSong.title;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            requestWakeLock();
        });

        // ì¬ìƒëª©ë¡ ë§Œë“¤ê¸° ê¸°ëŠ¥
createQueueBtn.addEventListener('click', () => {
    queueModal.classList.add('show');
    loadAvailableSongs();
    updateSelectedQueue();
});

closeQueueBtn.addEventListener('click', () => {
    queueModal.classList.remove('show');
});

queueModal.addEventListener('click', (e) => {
    if (e.target === queueModal) {
        queueModal.classList.remove('show');
    }
});

queueLoopOption.addEventListener('click', (e) => {
    if (e.target.id !== 'queueLoopCheckbox') {
        queueLoopCheckbox.checked = !queueLoopCheckbox.checked;
    }
    isQueueLooping = queueLoopCheckbox.checked;
});

queueLoopCheckbox.addEventListener('change', (e) => {
    isQueueLooping = e.target.checked;
});
function loadAvailableSongs() {
    availableSongsList.innerHTML = '';
    const allSongs = document.querySelectorAll('.playlist-item');
    
    // ë…¸ë˜ ë°ì´í„°ë¥¼ ë°°ì—´ë¡œ ìˆ˜ì§‘
    const songsArray = [];
    allSongs.forEach((item) => {
        songsArray.push({
            src: item.getAttribute('data-src'),
            icon: item.getAttribute('data-icon'),
            title: item.textContent
        });
    });

    // ì œëª© ê¸°ì¤€ ì•ŒíŒŒë²³ìˆœ ì •ë ¬
    songsArray.sort((a, b) => a.title.localeCompare(b.title));

    // ì •ë ¬ëœ ìˆœì„œë¡œ í‘œì‹œ
    songsArray.forEach((songData) => {
        const option = document.createElement('div');
        option.className = 'song-option';
        option.innerHTML = `
            <span>${songData.title}</span>
            <span>â•</span>
        `;
        
        option.addEventListener('click', () => {
            if (playQueue.length < MAX_QUEUE) {
                playQueue.push(songData);
                updateSelectedQueue();
                updateAvailableSongs();
            }
        });
        
        availableSongsList.appendChild(option);
    });

    // _RANDOM_ í•­ëª©ì„ ë§¨ ë§ˆì§€ë§‰ì— ì¶”ê°€
    const randomOption = document.createElement('div');
    randomOption.className = 'song-option';
    randomOption.style.background = 'linear-gradient(135deg, rgba(255, 100, 200, 0.2), rgba(100, 200, 255, 0.2))';
    randomOption.style.border = '2px solid rgba(255, 100, 200, 0.5)';
    randomOption.innerHTML = `
        <span style="font-weight: bold;">â‡„ _RANDOM_</span>
        <span>â•</span>
    `;
    
    randomOption.addEventListener('click', () => {
        if (playQueue.length < MAX_QUEUE) {
            playQueue.push({
                src: '_RANDOM_',
                icon: null,
                title: 'â‡„ _RANDOM_',
                isRandom: true,
                songsArray: songsArray
            });
            updateSelectedQueue();
            updateAvailableSongs();
        }
    });
    
    availableSongsList.appendChild(randomOption);
    
    updateAvailableSongs();
}

function updateAvailableSongs() {
    const options = availableSongsList.querySelectorAll('.song-option');
    options.forEach((option, index) => {
        if (playQueue.length >= MAX_QUEUE) {
            option.classList.add('disabled');
        } else {
            option.classList.remove('disabled');
        }
    });
}

function updateSelectedQueue() {
    selectedQueueList.innerHTML = '';
    
    if (playQueue.length === 0) {
        selectedQueueList.innerHTML = '<p style="color: rgba(255,255,255,0.5); text-align: center;">ë…¸ë˜ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>';
        startQueueBtn.disabled = true;
        return;
    }
    
    playQueue.forEach((song, index) => {
        const item = document.createElement('div');
        item.className = 'queue-item';
        item.innerHTML = `
            <span class="queue-number">${index + 1}</span>
            <span style="flex: 1; margin: 0 10px;">${song.title}</span>
            <button class="remove-queue-btn">ğŸ—‘ï¸</button>
        `;
        
        item.querySelector('.remove-queue-btn').addEventListener('click', () => {
            playQueue.splice(index, 1);
            updateSelectedQueue();
            updateAvailableSongs();
        });
        
        selectedQueueList.appendChild(item);
    });
    
    startQueueBtn.disabled = false;
    startQueueBtn.textContent = `â–¶ ì¬ìƒ ì‹œì‘ (${playQueue.length}ê³¡)`;
}

startQueueBtn.addEventListener('click', () => {
    if (playQueue.length === 0) return;
    
    isQueueMode = true;
      isQueueLooping = queueLoopCheckbox.checked;
    currentQueueIndex = 0;
    queueModal.classList.remove('show');
    currentQueueDiv.classList.add('show');
    
    playQueueSong(0);
    updateCurrentQueueDisplay();
});
function playQueueSong(index) {
    // ì¬ìƒëª©ë¡ ëë‚¬ì„ ë•Œ
    if (index >= playQueue.length) {
        if (isQueueLooping) {
            currentQueueIndex = 0;
            playQueueSong(0);
            return;
        } else {
            isQueueMode = false;
            currentQueueDiv.classList.remove('show');
            
            if (confirm('ì¬ìƒëª©ë¡ì´ ëª¨ë‘ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰\n\nê°™ì€ ì¬ìƒëª©ë¡ì„ ë‹¤ì‹œ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                isQueueMode = true;
                currentQueueIndex = 0;
                currentQueueDiv.classList.add('show');
                playQueueSong(0);
            }
            return;
        }
    }
    
    const song = playQueue[index];
    currentQueueIndex = index;
    
    // _RANDOM_ì¸ ê²½ìš° ì• ë‹ˆë©”ì´ì…˜ê³¼ í•¨ê»˜ ëœë¤ ì„ íƒ
    if (song.isRandom && song.songsArray) {
        // ëœë¤ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        songInfo.style.fontSize = '3em';
        songInfo.style.transition = 'none';
        
        let counter = 0;
        const maxCount = 20;
        const interval = setInterval(() => {
            const randomIndex = Math.floor(Math.random() * song.songsArray.length);
            songInfo.textContent = 'â‡„ ' + song.songsArray[randomIndex].title;
            songInfo.style.color = `hsl(${Math.random() * 360}, 100%, 70%)`;
            counter++;
            
            if (counter >= maxCount) {
                clearInterval(interval);
                // ìµœì¢… ì„ íƒ
                const finalIndex = Math.floor(Math.random() * song.songsArray.length);
                const randomSong = song.songsArray[finalIndex];
                
                songInfo.style.color = '#00ff00';
                const loopIndicator = isQueueLooping ? 'â†º' : '';
                songInfo.textContent = `âœ“ ${loopIndicator}${index + 1}/${playQueue.length} - ${randomSong.title}`;
                
                setTimeout(() => {
                    songInfo.style.fontSize = '2em';
                    songInfo.style.transition = 'all 0.3s';
                    
                    // ì„ íƒëœ ë…¸ë˜ë¡œ ì¬ìƒ
                    currentSong = randomSong;
                    audio.src = randomSong.src;
                    audio.playbackRate = currentSpeed;
                    audio.preservesPitch = (currentSpeed === 1.0);
                    
                    const loopIndicator = isQueueLooping ? 'â†º' : '';
                    songInfo.textContent = `${loopIndicator}${index + 1}/${playQueue.length} - ${randomSong.title}`;
                    
                    // ì•¨ë²” ì•„íŠ¸ ë¡œë“œ
                    if (randomSong.icon) {
                        const img = new Image();
                        img.onload = () => {
                            albumArt.src = randomSong.icon;
                            albumArt.classList.add('show');
                            albumBg.src = randomSong.icon;
                            albumBg.classList.add('show');
                        };
                        img.onerror = () => {
                            albumArt.classList.remove('show');
                            albumBg.classList.remove('show');
                        };
                        img.src = randomSong.icon;
                    } else {
                        albumArt.classList.remove('show');
                        albumBg.classList.remove('show');
                    }

                    if (animationId) {
                        cancelAnimationFrame(animationId);
                    }
                    
                    setupAudio();
                    audio.play();
                    isPlaying = true;
                    visualize();
                    playBtn.style.display = 'none';
                    pauseBtn.style.display = 'inline-block';
                    
                    updateCurrentQueueDisplay();
                }, 1000);
            }
        }, 100);
        
        return;
    }
    
    // ì¼ë°˜ ë…¸ë˜ ì¬ìƒ
    currentSong = song;
    audio.src = song.src;
    audio.playbackRate = currentSpeed;
    audio.preservesPitch = (currentSpeed === 1.0);
    
    const loopIndicator = isQueueLooping ? 'â†º' : '';
    const baseTitle = `${loopIndicator}${index + 1}/${playQueue.length} - ${song.title}`;
    
    if (currentSpeed === 0.9) {
        songInfo.textContent = 'â¬‡ Slowed - ' + baseTitle;
    } else if (currentSpeed === 1.1) {
        songInfo.textContent = 'â¬† Sped Up - ' + baseTitle;
    } else {
        songInfo.textContent = baseTitle;
    }
    
    // ì•¨ë²” ì•„íŠ¸ ë¡œë“œ
    if (song.icon) {
        const img = new Image();
        img.onload = () => {
            albumArt.src = song.icon;
            albumArt.classList.add('show');
            albumBg.src = song.icon;
            albumBg.classList.add('show');
        };
        img.onerror = () => {
            albumArt.classList.remove('show');
            albumBg.classList.remove('show');
        };
        img.src = song.icon;
    } else {
        albumArt.classList.remove('show');
        albumBg.classList.remove('show');
    }

    if (animationId) {
        cancelAnimationFrame(animationId);
    }
    
    setupAudio();
    audio.play();
    isPlaying = true;
    visualize();
    playBtn.style.display = 'none';
    pauseBtn.style.display = 'inline-block';
    
    updateCurrentQueueDisplay();
}

function updateCurrentQueueDisplay() {
    currentQueueList.innerHTML = '';
    
    // ì¹´ìš´í„° ì—…ë°ì´íŠ¸
    queueCounter.textContent = `${currentQueueIndex + 1}/${playQueue.length}`;
    
    // ë°˜ë³µ ìƒíƒœ í‘œì‹œ
    if (isQueueLooping) {
        const loopInfo = document.createElement('div');
        loopInfo.style.cssText = 'padding: 8px; margin-bottom: 10px; background: rgba(100, 200, 255, 0.2); border-radius: 5px; text-align: center; font-size: 0.9em; border: 1px solid rgba(100, 200, 255, 0.4);';
        loopInfo.innerHTML = 'â†º ë°˜ë³µ ì¬ìƒ ì¤‘';
        currentQueueList.appendChild(loopInfo);
    }
    
    playQueue.forEach((song, index) => {
        const item = document.createElement('div');
        item.className = 'current-queue-item';
        if (index === currentQueueIndex) {
            item.classList.add('playing');
        }
        
        // _RANDOM_ì¸ ê²½ìš° í‘œì‹œ
        if (song.isRandom) {
            item.textContent = `${index + 1}. â‡„ _RANDOM_`;
        } else {
            item.textContent = `${index + 1}. ${song.title}`;
        }
        
        currentQueueList.appendChild(item);
    });
}

// ë…¸ë˜ ì¢…ë£Œ ì‹œ ë‹¤ìŒ ê³¡ ì¬ìƒ

audio.addEventListener('ended', () => {
       if (isQueueMode) {
           currentQueueIndex++;
           playQueueSong(currentQueueIndex);
       } else if (audio.loop) {
           // ë°˜ë³µ ëª¨ë“œë©´ ë‹¤ì‹œ ì¬ìƒ
           audio.play();
       } else {
           // ì¼ë°˜ ì¢…ë£Œ
           cancelAnimationFrame(animationId);
           isPlaying = false;
           playBtn.style.display = 'inline-block';
           pauseBtn.style.display = 'none';
           if (currentSong) {
               songInfo.textContent = 'âœ… ' + currentSong.title;
           }
       }
   });

// ì•„ë˜ë¡œ êµì²´:
function updateSongTitle() {
    if (!currentSong) return;
    
    let prefix = '';
    let title = currentSong.title;
    

    
    // ì†ë„ í‘œì‹œ
    if (isSuperSlowed) {
        prefix = 'â¬‡â¬‡ SUPER Slowed';
    } else if (currentSpeed === 0.9) {
        prefix = 'â¬‡ Slowed';
    } else if (isSuperSpedUp) {
        prefix = 'â¬†â¬† SUPER Sped Up';
    } else if (currentSpeed === 1.1) {
        prefix = 'â¬† Sped Up';
    }
    
    // ì´í™íŠ¸ í‘œì‹œ
    if (currentEffect === 'bass') {
        prefix += (prefix ? ' + ' : '') + 'ğŸ”Š Bass';
    } else if (currentEffect === 'reverb') {
        prefix += (prefix ? ' + ' : '') + 'ğŸ›ï¸ Reverb';
    } else if (currentEffect === '8d') {
        prefix += (prefix ? ' + ' : '') + 'ğŸ§ 8D';
    }
    
    songInfo.textContent = prefix ? `${prefix} - ${title}` : title;
}

// ì´í™íŠ¸ ì ìš©
function applyEffect(effectType) {
    if (!audioContext || !source) return;
    
    removeAllEffects();
    currentEffect = effectType;
    updateEffectButtons(effectType);
    
    try {
        source.disconnect();
    } catch (e) {}
    
    if (effectType === 'reverb') {
        applyReverb();
    } else if (effectType === 'bass') {
        applyBassBoost();
    } else if (effectType === '8d') {
        apply8DAudio();
    } else {
        source.connect(analyser);
        analyser.connect(audioContext.destination);
    }
}

function applyReverb() {
    convolver = audioContext.createConvolver();
    const sampleRate = audioContext.sampleRate;
    const length = sampleRate * 0.6;  // ìš¸ë¦¼ ì‹œê°„ ë” ì§§ê²Œ
    const impulse = audioContext.createBuffer(2, length, sampleRate);
    
    for (let channel = 0; channel < 2; channel++) {
        const channelData = impulse.getChannelData(channel);
        for (let i = 0; i < length; i++) {
            channelData[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / length, 6) * 0.25;  
            // ë¹ ë¥´ê²Œ ê°ì‡ , ë³¼ë¥¨ 25%ë¡œ ê°ì†Œ
        }
    }
    
    convolver.buffer = impulse;
    
    // Dry/Wet ë¯¹ìŠ¤
    const dryGain = audioContext.createGain();
    const wetGain = audioContext.createGain();
    const outputGain = audioContext.createGain();
    
    dryGain.gain.value = 0.70;  // ì›ë³¸ ì†Œë¦¬ 85%
    wetGain.gain.value = 0.30;  // ìš¸ë¦¼ íš¨ê³¼ 15%ë§Œ
    
    source.connect(dryGain);
    source.connect(convolver);
    convolver.connect(wetGain);
    
    dryGain.connect(outputGain);
    wetGain.connect(outputGain);
    outputGain.connect(analyser);
    analyser.connect(audioContext.destination);
}

function applyBassBoost() {
    bassFilter = audioContext.createBiquadFilter();
    bassFilter.type = 'lowshelf';
    bassFilter.frequency.value = 200;
    bassFilter.gain.value = 18;
    
    source.connect(bassFilter);
    bassFilter.connect(analyser);
    analyser.connect(audioContext.destination);
}

function apply8DAudio() {
    panner = audioContext.createStereoPanner();
    let angle = 0;
    eightDInterval = setInterval(() => {
        angle += 0.04;
        panner.pan.value = Math.sin(angle);
    }, 50);
    
    source.connect(panner);
    panner.connect(analyser);
    analyser.connect(audioContext.destination);
}

function removeAllEffects() {
    if (eightDInterval) {
        clearInterval(eightDInterval);
        eightDInterval = null;
    }
    if (convolver) { try { convolver.disconnect(); } catch (e) {} convolver = null; }
    if (bassFilter) { try { bassFilter.disconnect(); } catch (e) {} bassFilter = null; }
    if (panner) { try { panner.disconnect(); } catch (e) {} panner = null; }
}

function updateEffectButtons(active) {
    [normalEffectBtn, bassBoostBtn, reverbBtn, eightDBtn].forEach(btn => {
        btn?.classList.remove('active');
    });
    if (active === 'reverb') reverbBtn?.classList.add('active');
    else if (active === 'bass') bassBoostBtn?.classList.add('active');
    else if (active === '8d') eightDBtn?.classList.add('active');
    else normalEffectBtn?.classList.add('active');
}

// ì´í™íŠ¸ ë²„íŠ¼ ì´ë²¤íŠ¸
normalEffectBtn?.addEventListener('click', () => applyEffect('normal'));
bassBoostBtn?.addEventListener('click', () => applyEffect('bass'));
reverbBtn?.addEventListener('click', () => applyEffect('reverb'));
eightDBtn?.addEventListener('click', () => applyEffect('8d'));

// íƒ­ ì „í™˜
speedTab?.addEventListener('click', () => {
    speedTab.classList.add('active');
    effectTab.classList.remove('active');
    speedTabContent.classList.add('active');
    effectTabContent.classList.remove('active');
});

effectTab?.addEventListener('click', () => {
    effectTab.classList.add('active');
    speedTab.classList.remove('active');
    effectTabContent.classList.add('active');
    speedTabContent.classList.remove('active');
});

        prevBtn.addEventListener('click', () => {
                if (!currentSong || !audio.duration) return; 
            audio.currentTime = Math.max(0, audio.currentTime - 10);
        });

        nextBtn.addEventListener('click', () => {
                if (!currentSong || !audio.duration) return; 
            audio.currentTime = Math.min(audio.duration, audio.currentTime + 10);
        });

        progressBar.addEventListener('click', (e) => {
            if (!currentSong) return;
            const rect = progressBar.getBoundingClientRect();
            const percent = (e.clientX - rect.left) / rect.width;
            audio.currentTime = percent * audio.duration;
        });

        // ë°˜ë³µ ë²„íŠ¼
loopBtn.addEventListener('click', () => {
    audio.loop = !audio.loop;
    if (audio.loop) {
        loopBtn.classList.add('active');
        loopBtn.textContent = 'â†º ë°˜ë³µ ON';
    } else {
        loopBtn.classList.remove('active');
        loopBtn.textContent = 'â†º ë°˜ë³µ';
    }
});

        audio.addEventListener('timeupdate', () => {
            if (audio.duration) {
                const percent = (audio.currentTime / audio.duration) * 100;
                progressFill.style.width = percent + '%';
                currentTimeEl.textContent = formatTime(audio.currentTime);
                totalTimeEl.textContent = formatTime(audio.duration);
            }
        });

     

        audio.addEventListener('error', () => {
            songInfo.textContent = 'âŒ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
            songInfo.style.color = '#ff4444';
        });

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function visualize() {
            const bufferLength = analyser.frequencyBinCount;
            const dataArray = new Uint8Array(bufferLength);

            function draw() {
                if (!isPlaying) return;
                animationId = requestAnimationFrame(draw);
                analyser.getByteFrequencyData(dataArray);

                const width = canvas.width;
                const height = canvas.height;
                const centerX = width / 2;
                const centerY = height * 0.5;

                ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';
                ctx.fillRect(0, 0, width, height);

                const barCount = 128;
                const radius = Math.min(width, height) * 0.25;
                const barWidth = (Math.PI * 2) / barCount;

                for (let i = 0; i < barCount; i++) {
const dataIndex = Math.floor(Math.pow(i / barCount, 1.5) * bufferLength * 0.6);                   
 const value = dataArray[dataIndex];
                    const barHeight = (value / 255) * (radius * 1.2);
                    const angle = (i * barWidth) - Math.PI / 2;
                    
                    const x1 = centerX + Math.cos(angle) * radius;
                    const y1 = centerY + Math.sin(angle) * radius;
                    const x2 = centerX + Math.cos(angle) * (radius + barHeight);
                    const y2 = centerY + Math.sin(angle) * (radius + barHeight);
                    
                 const hue = (i / barCount) * 360;
                    const brightness = 50 + (value / 255) * 50;
                    
                    ctx.strokeStyle = `hsl(${hue}, 100%, ${brightness}%)`;
                    ctx.lineWidth = 4;
                    ctx.beginPath();
                    ctx.moveTo(x1, y1);
                    ctx.lineTo(x2, y2);
                    ctx.stroke();
                    
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = `hsl(${hue}, 100%, ${brightness}%)`;
                }

                ctx.shadowBlur = 30;
                ctx.shadowColor = '#000000'; 
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius * 0.9, 0, Math.PI * 2);
                ctx.strokeStyle = 'rgba(0, 0, 0, 0.5)';
                ctx.lineWidth = 2;
                ctx.stroke();

                const bassAvg = dataArray.slice(0, 10).reduce((a, b) => a + b, 0) / 10;
             
                const pulseRadius = radius * 0.3 + (bassAvg / 255) * (radius * 0.3);
                
                
                const pulseGradient = ctx.createRadialGradient(
                    centerX, centerY, 0,
                    centerX, centerY, pulseRadius
                );
                pulseGradient.addColorStop(0, 'rgba(0, 240, 255, 0.3)');
                pulseGradient.addColorStop(1, 'rgba(0, 240, 255, 0)');
                
                ctx.fillStyle = pulseGradient;
                ctx.beginPath();
                ctx.arc(centerX, centerY, pulseRadius, 0, Math.PI * 2);
                ctx.fill();
            }

            draw();
        }
    </script>
</body>
</html>
